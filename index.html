<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Appendix: Code Snippets</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background: #f9f9f9; }
    h1 { color: #2c3e50; }
    table { border-collapse: collapse; width: 100%; background: white; }
    th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
    th { background-color: #2c3e50; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    code { background-color: #f4f4f4; padding: 2px 4px; font-family: monospace; display: block; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>Appendix: Code Snippets</h1>
  <p>This appendix contains the key code snippets used in the project (without results or chapter references).</p>
  <table>
    <tr><th>Section</th><th>Key Code Snippet</th></tr>
    <tr><td>Imports</td><td><code>import tensorflow as tf
import torch
from sklearn.svm import SVC
from skimage.feature import hog
import numpy as np
np.random.seed(42)
tf.random.set_seed(42)
torch.manual_seed(42)</code></td></tr>

    <tr><td>Dataset Loading</td><td><code>(x_train, y_train), (x_test, y_test) = tf.keras.datasets.cifar10.load_data()
class_names = ['airplane','automobile','bird','cat','deer','dog','frog','horse','ship','truck']</code></td></tr>

    <tr><td>Preprocessing</td><td><code>def preprocess_data(x, y, image_size=(224,224)):
    x = tf.image.resize(x, image_size).numpy()/255.0
    y = y.flatten()
    return x,y</code></td></tr>

    <tr><td>MobileNetV2 Setup</td><td><code>base_model = tf.keras.applications.MobileNetV2(weights='imagenet', include_top=False, input_shape=(224,224,3))
base_model.trainable = False
model = tf.keras.Sequential([
    base_model,
    tf.keras.layers.GlobalAveragePooling2D(),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dropout(0.5),
    tf.keras.layers.Dense(10, activation='softmax')
])</code></td></tr>

    <tr><td>Training</td><td><code>model.compile(optimizer=tf.keras.optimizers.Adam(0.001),
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])
history = model.fit(...)</code></td></tr>

    <tr><td>Fine-Tuning (PyTorch)</td><td><code>import torch.nn as nn
from torchvision import models

model_torch = models.mobilenet_v2(pretrained=True)
model_torch.classifier = nn.Sequential(
    nn.Linear(1280,128), nn.ReLU(), nn.Dropout(0.5), nn.Linear(128,10)
)
for param in model_torch.features[-10:].parameters():
    param.requires_grad = True</code></td></tr>

    <tr><td>SVM Baseline</td><td><code>fd = hog(img, pixels_per_cell=(8,8), cells_per_block=(2,2), channel_axis=2)
svm = SVC(kernel='rbf', random_state=42)
svm.fit(x_train_hog, y_train)</code></td></tr>

    <tr><td>Evaluation</td><td><code>from sklearn.metrics import classification_report, confusion_matrix
print(classification_report(y_test,y_pred))</code></td></tr>

    <tr><td>Robustness Testing</td><td><code>def fgsm_attack(model, images, labels, epsilon=0.1):
    with tf.GradientTape() as tape:
        tape.watch(images)
        predictions = model(images)
        loss = tf.keras.losses.SparseCategoricalCrossentropy()(labels, predictions)
    gradient = tape.gradient(loss, images)
    return np.clip(images + epsilon * tf.sign(gradient),0,1)</code></td></tr>
  </table>
</body>
</html>
